---
title: "STAT 537 HW 8"
author: "Mark Greenwood"
date: ''
output:
  pdf_document: default
  word_document: null
---

Due on Wednesday, April 6, at 5 pm. You can work in a group of up to three but at least one group member needs to be different from the last assignment.

Continuing with Chang, Hansen, and Piekielek (2014), we will explore EFA of the variables.

For this work, we will continue to drop pack7 and pack8 which are almost always 0s (see code below).


```{r, warning=F,message=F}

# tc1<-read.csv("https://montana.box.com/shared/static/m5tv7r4ce7mw3w0vyqu0q7i1f8jflkkc.csv",header=T) #Data set without any modifications from https://knb.ecoinformatics.org/#view/doi:10.5063/F1DZ067F
tc1 <- read.csv("tc1.csv")
tc1$responsef<-factor(tc1$response)
tc1_r<-tc1[,c(4:39,64:75)]

table(tc1_r$pack7)
table(tc1_r$pack8)

tc2<-tc1_r[,-c(43,44)]

require(GPArotation) #Or else you'll have problems with fa()

```

1) Use fa.parallel from the psych package to consider how many factors you should use with the Q=46 variables. Discuss the results. How many factors would you use and why?

```{r p1_a, echo=F, warning=F, message=F, cache=T, fig.height=8, fig.width=8}


```

2) Generate a varimax rotated two-factor solution and provide a path diagram with simple=T as an option. Name and interpret the two factors using a simple structure interpretation.

```{r p2_a, echo=F, warning=F, message=F, cache=T, fig.height=8, fig.width=8}


```

3) What does the likelihood ratio test suggest about a two factor solution in this output? Make sure to report hypotheses tested, test statistic, distribution under the null, and p-value.

```{r p3_a, echo=F, warning=F, message=F, cache=T, fig.height=8, fig.width=8}


```

4) In this solution, which two manifest variables are least explained? How did you determine this?

5) Now make a path diagram with the simple=F option but try cutting off displaying paths with the option cut=0.4 and then cut=0.5. Discuss generally how things changed. Do not attempt a detailed interpretation of the solution but do discuss whether your previous names of the factors would need to change based on this updated diagram.

```{r p5_a, echo=F, warning=F, message=F, cache=T, fig.height=8, fig.width=8}


```

6) Consider a promax rotation with 2 factors and remake the simple=T path diagram. How did the two factors change? Provide names for the two factors if they are different from the varimax version.

```{r p6_a, echo=F, warning=F, message=F, cache=T, fig.height=8, fig.width=8}


```

7) Check your two poorly explained manifest variables. Did the amount of their variation explained change or remain the same? Explain this result.

```{r p7_a, echo=F, warning=F, message=F, cache=T, fig.height=8, fig.width=8}


```

8) Repeat the path diagram with simple=F, leaving the path display cutoff at the default setting. What is the default cutoff setting? How did the promax non-simple display compare to the results from varimax? How can you explain these differences in complexity of solutions? 

```{r p8_a, echo=F, warning=F, message=F, cache=T, fig.height=8, fig.width=8}


```

## R Code Appendix:
Problem 1:
```{r a1, ref.label='p1_a', eval=F}
```

Problem 2:
```{r a2, ref.label='p2_a', eval=F}
```

Problem 3:
```{r a3, ref.label='p3_a', eval=F}
```

Problem 5:
```{r a5, ref.label='p5_a', eval=F}
```

Problem 6:
```{r a6, ref.label='p6_a', eval=F}
```

Problem 7:
```{r a7, ref.label='p7_a', eval=F}
```

Problem 8:
```{r a8, ref.label='p8_a', eval=F}
```

